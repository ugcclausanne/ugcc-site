{# Reverted to Font Awesome icons for stability #}
<header class="header">
  <div class="container">
    <div class="header-top-row grid-header">
      <a class="header-logo-titles header-home-link" href="{{ base }}{{ header.menu[0].url }}">
        {% set _logo = logo_image %}
        {% if (_logo | substr(0,4)) != 'http' %}
          {% if (_logo | substr(0,1)) == '/' %}
            {% set _logo = base + _logo %}
          {% else %}
            {% set _logo = base + '/' + _logo %}
          {% endif %}
        {% endif %}
        <img src="{{ _logo }}" alt="UGCC Logo" class="header-logo-full">
        <div class="header-titles">
          <div class="header-title-small">{{ header.siteSubtitle }}</div>
          <h1 class="header-title">{{ header.siteName }}</h1>
        </div>
      </a>
      <div class="header-actions-right">
        <div class="header-actions-grid">
          <button class="icon-btn menu-toggle" aria-expanded="false" aria-controls="main-menu" title="Menu">
            <span class="burger" aria-hidden="true"><span></span><span></span><span></span></span>
          </button>
          <div class="socials-row">
            <span class="socials socials-header">
              {% set socials = social_list or footer.social %}
              {% for social in socials %}
                <a href="{{ social.url }}" title="{{ social.title }}"><i class="fa-brands fa-{{ social.title | lower }}"></i></a>
              {% endfor %}
            </span>
            {# Language toggle: globe icon only, inline with other icons, before search #}
            {% set currentPage = page %}
            {% set urlUk = '/' if currentPage == 'index' else '/' + currentPage + '/' %}
            {% set urlFr = '/fr/' if currentPage == 'index' else '/fr/' + currentPage + '/' %}
            {% set urlEn = '/en/' if currentPage == 'index' else '/en/' + currentPage + '/' %}
            <div class="lang-dropdown">
              <button class="icon-btn lang-btn" aria-expanded="false" aria-controls="lang-menu" title="{{ header.langTitle }}">
                <i class="fa-solid fa-globe"></i>
              </button>
              <ul id="lang-menu" class="lang-list" role="menu" hidden>
                <li role="menuitem"><a href="{{ base }}{{ urlUk }}">Українська</a></li>
                <li role="menuitem"><a href="{{ base }}{{ urlFr }}">Français</a></li>
                <li role="menuitem"><a href="{{ base }}{{ urlEn }}">English</a></li>
              </ul>
            </div>
            <button class="icon-btn search-toggle" aria-expanded="false" title="{{ header.searchPlaceholder }}">
              <i class="fa-solid fa-magnifying-glass"></i>
            </button>
          </div>
					<a class="donate-link" href="{{ base }}{{ header.menu[7].url }}"><i class="fa-solid fa-heart" aria-hidden="true"></i><span class="label-text">&nbsp;{{ header.donateCta }}</span></a>
          <form class="header-search" action="#" method="get">
            <input type="text" placeholder="{{ header.searchPlaceholder }}" name="q">
          </form>
        </div>
      </div>
    </div>
  </div>
  <nav class="header-menu-row" aria-label="Main navigation">
    <div class="container">
      {% set currentUrl = '/' %}
      {% if lang == 'uk' %}
        {% set currentUrl = '/' if page == 'index' else '/' + page + '/' %}
      {% else %}
        {% set currentUrl = '/' + lang + '/' if page == 'index' else '/' + lang + '/' + page + '/' %}
      {% endif %}
      <ul id="main-menu">
        {% for item in header.menu %}
          {% if item.url != '/' and item.url != '/en/' and item.url != '/fr/' and ('/donate/' not in item.url) %}
            {% set isActive = (item.url == currentUrl) %}
            <li><a href="{{ base }}{{ item.url }}" class="{% if item.cta %}cta {% endif %}{% if isActive %}active{% endif %}">{{ item.title }}</a></li>
          {% endif %}
        {% endfor %}
      </ul>
    </div>
  </nav>
</header>
